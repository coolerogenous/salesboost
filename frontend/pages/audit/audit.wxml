<view class="container">
  <view class="top-nav">
    <view class="title">待审核记录 ({{submissions.length}})</view>
  </view>

  <scroll-view scroll-y class="list-container">
    <block wx:for="{{submissions}}" wx:key="id">
      <view class="audit-card">
        <view class="user-info">
          <text class="staff">{{item.username}} ({{item.staff_id}})</text>
          <text class="time">{{item.submitted_at}}</text>
        </view>
        <view class="task-name">任务：{{item.task_title}}</view>
        
        <!-- 备注信息 -->
        <view class="remarks" wx:if="{{item.text_content}}">
          <text class="label">备注：</text>{{item.text_content}}
        </view>

        <view class="img-hint" wx:if="{{item.imageList.length > 0}}">共 {{item.imageList.length}} 张图片，点击可预览</view>
        
        <scroll-view scroll-x="true" class="img-scroll" wx:if="{{item.imageList.length > 0}}">
          <view class="img-container">
            <block wx:for="{{item.imageList}}" wx:key="*this" wx:for-item="img">
              <image class="proof-img" src="{{img}}" mode="aspectFill" bindtap="previewImage" data-url="{{img}}" data-urls="{{item.imageList}}"></image>
            </block>
          </view>
        </scroll-view>
        
        <view class="btn-group">
          <button class="btn-reject" bindtap="showRejectDialog" data-id="{{item.id}}">驳回</button>
          <button class="btn-approve" bindtap="handleApprove" data-id="{{item.id}}">通过</button>
        </view>
      </view>
    </block>
    <view wx:if="{{submissions.length === 0}}" class="empty">暂无待审核内容</view>
  </scroll-view>

  <!-- 驳回理由弹窗 -->
  <view class="modal" wx:if="{{showRejectModal}}">
    <view class="modal-content">
      <view class="modal-title">驳回理由</view>
      <input class="modal-input" placeholder="请输入驳回理由" bindinput="onRejectReasonInput" />
      <view class="modal-btns">
        <text class="modal-cancel" bindtap="hideRejectDialog">取消</text>
        <text class="modal-confirm" bindtap="handleReject">确定驳回</text>
      </view>
    </view>
  </view>
</view>
